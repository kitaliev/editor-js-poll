!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.Poll=e():t.Poll=e()}(window,(function(){return function(t){var e={};function n(o){if(e[o])return e[o].exports;var r=e[o]={i:o,l:!1,exports:{}};return t[o].call(r.exports,r,r.exports,n),r.l=!0,r.exports}return n.m=t,n.c=e,n.d=function(t,e,o){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:o})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var o=Object.create(null);if(n.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)n.d(o,r,function(e){return t[e]}.bind(null,r));return o},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="/",n(n.s=0)}([function(t,e,n){function o(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}n(1).toString();var r=function(){function t(e){var n,o,r,a=e.data,i=e.api,c=e.block;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),r="editor-js-poll-plugin",(o="rootClass")in(n=this)?Object.defineProperty(n,o,{value:r,enumerable:!0,configurable:!0,writable:!0}):n[o]=r,this.data=a,this.api=i,this.blockAPI=c}var e,n,r;return e=t,r=[{key:"toolbox",get:function(){return{title:"Опрос",icon:'<svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M21 22.75H3C2.59 22.75 2.25 22.41 2.25 22C2.25 21.59 2.59 21.25 3 21.25H21C21.41 21.25 21.75 21.59 21.75 22C21.75 22.41 21.41 22.75 21 22.75Z" fill="#292D32"/><path d="M5.6 8.38H4C3.45 8.38 3 8.83 3 9.38V18C3 18.55 3.45 19 4 19H5.6C6.15 19 6.6 18.55 6.6 18V9.38C6.6 8.82 6.15 8.38 5.6 8.38Z" fill="#292D32"/><path d="M12.8002 5.18994H11.2002C10.6502 5.18994 10.2002 5.63994 10.2002 6.18994V17.9999C10.2002 18.5499 10.6502 18.9999 11.2002 18.9999H12.8002C13.3502 18.9999 13.8002 18.5499 13.8002 17.9999V6.18994C13.8002 5.63994 13.3502 5.18994 12.8002 5.18994Z" fill="#292D32"/><path d="M19.9999 2H18.3999C17.8499 2 17.3999 2.45 17.3999 3V18C17.3999 18.55 17.8499 19 18.3999 19H19.9999C20.5499 19 20.9999 18.55 20.9999 18V3C20.9999 2.45 20.5499 2 19.9999 2Z" fill="#292D32"/></svg>'}}}],(n=[{key:"render",value:function(){var t=this;this.root=document.createElement("div"),this.root.classList.add(this.rootClass),this.root.classList.add("cdx-block"),this.root.innerHTML='<div class="'.concat(this.rootClass,'__header">\n      <input class="').concat(this.rootClass,'__input cdx-input" placeholder="Вопрос" type="text" />\n      <div class="').concat(this.rootClass,'__header-checks">\n        <label class="').concat(this.rootClass,'__checkbox" title="Пользователь может выбрать несколько правильных ответов">\n          <input type="checkbox">\n          <span>Несколько ответов</span>\n        </label>\n        <label class="').concat(this.rootClass,'__checkbox" title="Опрос с правильными и неправильными ответами">\n          <input type="checkbox">\n          <span>Викторина</span>\n        </label>\n      </div>\n    </div>\n    <div class="').concat(this.rootClass,'__body"></div>'),this.data&&(this.root.querySelector(".".concat(this.rootClass,"__header .").concat(this.rootClass,"__input")).value=this.data.question||"");var e=this.root.querySelector(".".concat(this.rootClass,"__header .").concat(this.rootClass,"__checkbox:first-child input"));this.api.listeners.on(e,"change",(function(e){t.root.querySelectorAll(".".concat(t.rootClass,"__body .").concat(t.rootClass,"__checkbox input")).forEach((function(t){t.setAttribute("type",e.target.checked?"checkbox":"radio")})),t.data.multiple=e.target.checked})),this.data&&(e.checked=this.data.multiple);var n=this.root.querySelector(".".concat(this.rootClass,"__header .").concat(this.rootClass,"__checkbox:last-child input"));return this.data.quiz&&(n.checked=this.data.quiz),this.api.listeners.on(n,"change",(function(n){t.data.quiz=n.target.checked,t.root.querySelectorAll(".".concat(t.rootClass,"__body .").concat(t.rootClass,"__checkbox")).forEach((function(o){o.setAttribute("type",e.checked?"checkbox":"radio"),n.target.checked?o.classList.remove("".concat(t.rootClass,"__hidden")):o.classList.add("".concat(t.rootClass,"__hidden"))}))})),this.data&&this.data.answers&&this.data.answers.forEach((function(e){e.value.trim().length&&t.root.querySelector(".".concat(t.rootClass,"__body")).append(t.getAnswer(e.value,e.checked))})),this.data&&this.data.answers&&this.data.answers.length&&this.data.answers.reduce((function(t,e){return t+!e.value.trim().length?1:0}),0).length||this.root.querySelector(".".concat(this.rootClass,"__body")).appendChild(this.getAnswer()),this.root.querySelectorAll(".".concat(this.rootClass,"__body .").concat(this.rootClass,"__answer")).forEach((function(e){t.api.listeners.on(e.querySelector(".".concat(t.rootClass,"__checkbox input")),"change",(function(){t.blockAPI.dispatchChange()}),!1),t.api.listeners.on(e.querySelector(".".concat(t.rootClass,"__input")),"input",(function(){t.handleAnswerInput()}),!1)})),this.root}},{key:"save",value:function(t){var e=this,n=Array.from(t.querySelectorAll(".".concat(this.rootClass,"__body .").concat(this.rootClass,"__answer"))).map((function(t){return{value:t.querySelector(".".concat(e.rootClass,"__input")).value,checked:t.querySelector(".".concat(e.rootClass,"__checkbox input")).checked||!1}}));return n=n.filter((function(t){return!!t.value.trim().length})),{question:t.querySelector(".".concat(this.rootClass,"__header .").concat(this.rootClass,"__input")).value,multiple:t.querySelector(".".concat(this.rootClass,"__header .").concat(this.rootClass,"__checkbox:first-child input")).checked||!1,quiz:t.querySelector(".".concat(this.rootClass,"__header .").concat(this.rootClass,"__checkbox:last-child input")).checked||!1,answers:n}}},{key:"handleAnswerInput",value:function(){var t=this;if(this.root.querySelectorAll(".".concat(this.rootClass,"__body .").concat(this.rootClass,"__input")).forEach((function(t){t.value.trim().length||t.parentNode.remove()})),!Array.from(this.root.querySelectorAll(".".concat(this.rootClass,"__body .").concat(this.rootClass,"__input"))).reduce((function(t,e){return t+!e.value.trim().length?1:0}),0)){var e=this.getAnswer();this.api.listeners.on(e.querySelector(".".concat(this.rootClass,"__input")),"input",(function(){t.handleAnswerInput()}),!1),this.api.listeners.on(e.querySelector(".".concat(this.rootClass,"__checkbox input")),"input",(function(){}),!1),this.root.querySelector(".".concat(this.rootClass,"__body")).appendChild(e)}}},{key:"getAnswer",value:function(t,e){var n,o=document.createElement("div");return o.classList.add("".concat(this.rootClass,"__answer")),o.innerHTML='<label class="'.concat(this.rootClass,"__checkbox ").concat(this.data.quiz?"":"".concat(this.rootClass,"__hidden"),'" title="Правильный ответ"><input name="').concat((null===(n=this.blockAPI)||void 0===n?void 0:n.id)||"",'" type="').concat(this.data.multiple?"checkbox":"radio",'"></label>\n      <input type="text" class="').concat(this.rootClass,'__input cdx-input" placeholder="Вариант ответа" />'),o.querySelector(".".concat(this.rootClass,"__checkbox input")).checked=e||!1,o.querySelector(".".concat(this.rootClass,"__input")).value=t||"",o}}])&&o(e.prototype,n),r&&o(e,r),Object.defineProperty(e,"prototype",{writable:!1}),t}();t.exports=r},function(t,e,n){var o=n(2),r=n(3);"string"==typeof(r=r.__esModule?r.default:r)&&(r=[[t.i,r,""]]);var a={insert:"head",singleton:!1};o(r,a);t.exports=r.locals||{}},function(t,e,n){"use strict";var o,r=function(){return void 0===o&&(o=Boolean(window&&document&&document.all&&!window.atob)),o},a=function(){var t={};return function(e){if(void 0===t[e]){var n=document.querySelector(e);if(window.HTMLIFrameElement&&n instanceof window.HTMLIFrameElement)try{n=n.contentDocument.head}catch(t){n=null}t[e]=n}return t[e]}}(),i=[];function c(t){for(var e=-1,n=0;n<i.length;n++)if(i[n].identifier===t){e=n;break}return e}function s(t,e){for(var n={},o=[],r=0;r<t.length;r++){var a=t[r],s=e.base?a[0]+e.base:a[0],l=n[s]||0,u="".concat(s," ").concat(l);n[s]=l+1;var d=c(u),h={css:a[1],media:a[2],sourceMap:a[3]};-1!==d?(i[d].references++,i[d].updater(h)):i.push({identifier:u,updater:y(h,e),references:1}),o.push(u)}return o}function l(t){var e=document.createElement("style"),o=t.attributes||{};if(void 0===o.nonce){var r=n.nc;r&&(o.nonce=r)}if(Object.keys(o).forEach((function(t){e.setAttribute(t,o[t])})),"function"==typeof t.insert)t.insert(e);else{var i=a(t.insert||"head");if(!i)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");i.appendChild(e)}return e}var u,d=(u=[],function(t,e){return u[t]=e,u.filter(Boolean).join("\n")});function h(t,e,n,o){var r=n?"":o.media?"@media ".concat(o.media," {").concat(o.css,"}"):o.css;if(t.styleSheet)t.styleSheet.cssText=d(e,r);else{var a=document.createTextNode(r),i=t.childNodes;i[e]&&t.removeChild(i[e]),i.length?t.insertBefore(a,i[e]):t.appendChild(a)}}function p(t,e,n){var o=n.css,r=n.media,a=n.sourceMap;if(r?t.setAttribute("media",r):t.removeAttribute("media"),a&&"undefined"!=typeof btoa&&(o+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(a))))," */")),t.styleSheet)t.styleSheet.cssText=o;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(o))}}var f=null,_=0;function y(t,e){var n,o,r;if(e.singleton){var a=_++;n=f||(f=l(e)),o=h.bind(null,n,a,!1),r=h.bind(null,n,a,!0)}else n=l(e),o=p.bind(null,n,e),r=function(){!function(t){if(null===t.parentNode)return!1;t.parentNode.removeChild(t)}(n)};return o(t),function(e){if(e){if(e.css===t.css&&e.media===t.media&&e.sourceMap===t.sourceMap)return;o(t=e)}else r()}}t.exports=function(t,e){(e=e||{}).singleton||"boolean"==typeof e.singleton||(e.singleton=r());var n=s(t=t||[],e);return function(t){if(t=t||[],"[object Array]"===Object.prototype.toString.call(t)){for(var o=0;o<n.length;o++){var r=c(n[o]);i[r].references--}for(var a=s(t,e),l=0;l<n.length;l++){var u=c(n[l]);0===i[u].references&&(i[u].updater(),i.splice(u,1))}n=a}}}},function(t,e,n){(e=n(4)(!1)).push([t.i,".editor-js-poll-plugin {\n  display: grid;\n  grid-gap: 16px;\n  background: #ffffff;\n  border-radius: 5px;\n}\n.editor-js-poll-plugin__header {\n  display: grid;\n  grid-gap: 8px;\n}\n\n.editor-js-poll-plugin__header-checks {\n  display: flex;\n  align-items: center;\n  gap: 8px;\n}\n\n.editor-js-poll-plugin__checkbox {\n  display: flex;\n  align-items: center;\n  font-size: 0.875em;\n  gap: 2px;\n}\n\n.editor-js-poll-plugin__body {\n  display: grid;\n  grid-gap: 10px;\n}\n\n.editor-js-poll-plugin__answer {\n  display: flex;\n  align-items: center;\n  gap: 16px;\n}\n\n.editor-js-poll-plugin__hidden {\n  display: none;\n}\n",""]),t.exports=e},function(t,e,n){"use strict";t.exports=function(t){var e=[];return e.toString=function(){return this.map((function(e){var n=function(t,e){var n=t[1]||"",o=t[3];if(!o)return n;if(e&&"function"==typeof btoa){var r=(i=o,c=btoa(unescape(encodeURIComponent(JSON.stringify(i)))),s="sourceMappingURL=data:application/json;charset=utf-8;base64,".concat(c),"/*# ".concat(s," */")),a=o.sources.map((function(t){return"/*# sourceURL=".concat(o.sourceRoot||"").concat(t," */")}));return[n].concat(a).concat([r]).join("\n")}var i,c,s;return[n].join("\n")}(e,t);return e[2]?"@media ".concat(e[2]," {").concat(n,"}"):n})).join("")},e.i=function(t,n,o){"string"==typeof t&&(t=[[null,t,""]]);var r={};if(o)for(var a=0;a<this.length;a++){var i=this[a][0];null!=i&&(r[i]=!0)}for(var c=0;c<t.length;c++){var s=[].concat(t[c]);o&&r[s[0]]||(n&&(s[2]?s[2]="".concat(n," and ").concat(s[2]):s[2]=n),e.push(s))}},e}}])}));